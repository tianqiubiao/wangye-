<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <script>
        ;
        (function (doc, win) {
            var docEl = doc.documentElement, statWidth = docEl.clientWidth,
                resizeEvt                              = 'orientationchange' in window ? 'orientationchange' : 'resize',
                recalc                                 = function () {
                    var clientWidth = docEl.clientWidth;
                    if (!clientWidth) return;
                    docEl.style.fontSize = 100 * (clientWidth / 360) + 'px';
                };
            if (!doc.addEventListener) return;
            win.addEventListener(resizeEvt, recalc, false);
            doc.addEventListener('DOMContentLoaded', recalc, false);
        })(document, window);
    </script>
    <link rel="stylesheet" href="public/stylesheets/app.css">
    <title>Title</title>
</head>
<body>
<div class="min-height100 bgG2 padTop25">
    <div style="height: 1.5rem;" class="colorWhite font20 line_height30" id="aDiv" ></div>
    <div><img src="public/images/b2.jpg" alt="" id="aImg"></div>
</div>

<select style="width: 100%;position: fixed;top: 0;" id="scl">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>5</option>
    <option>6</option>
</select>
</body>
</html>
<script src="public/javascripts/app.js"></script>
<script>
    var img = query('#aImg'), div = query('#aDiv'), x, y, x1, y1, c,scl = query('#scl'),num=1;
    scl.onchange=function(){
        num=scl.value;
    }
    img.onload = function () {
        img.style.maxWidth = '1000%';
        img.addEventListener('touchstart', function (e) {
                                 //alert(e.touches.length)
                                 if (e.touches.length === 2) {
                                     var a, b,sb,sc;
                                     y = e.targetTouches[0].pageY;
                                     x = e.targetTouches[0].pageX;
                                     y1 = e.targetTouches[1].pageY;
                                     x1 = e.targetTouches[1].pageX;
                                     //计算三角两边;
                                     sb= x>x1?x-x1:x1-x;
                                     sa= y>y1?y-y1:y1-y;
                                     c=sb*sb+sa*sa;
                                     div.innerHTML = '手指数：' + e.touches.length + '<br>手指间距：'+Math.sqrt(c)+'<br>初始间距：'+Math.sqrt(c);

                                 } else {
//                startLeft = e.targetTouches[0].pageX;
//                left = getCss(dix, 'left');
                                 }
                             }
        );
        img.addEventListener('touchmove', function (e) {
                                 e.preventDefault();
                                 if (e.touches.length === 2) {
                                     var t, f, t1, f1,a, b,ea,eb,ec;
                                     t = e.targetTouches[0].pageY;
                                     t1 = e.targetTouches[1].pageY ;
                                     f1 = e.targetTouches[1].pageX;
                                     f = e.targetTouches[0].pageX;
//放大、缩小值为对立的；
  //a:y轴  ，b:x轴   c：斜边；
                                     var q,wid;
                                     ea= t>t1?t-t1:t1-t;
                                     eb= f>f1?f-f1:f1-f;
                                     ec=ea*ea+eb*eb;
                                     if(ec>c){//放大
                                        c=ec;
                                          wid=parseFloat( window.getComputedStyle(img,null)['width']);
                                         img.style.width=wid+num +'px';
                                         q='放大'
                                     }else if(c>ec){//缩小
                                         c=ec;
                                          wid=parseFloat(window.getComputedStyle(img,null)['width']);
                                         img.style.width=wid-num+'px';
                                         q='缩小'
                                     }else {
q='无'
                                     }
                                     div.innerHTML = '手指数：' + e.touches.length + '<br>手指间距：'+Math.sqrt(ec)+'<br>状态：'+q+'<br>图片宽'+window.getComputedStyle(img,null)['width'];
                                 } else {
//                                     var wi=parseFloat(window.getComputedStyle(img,null)['width']);
//                                     img.style.width=wi+1 +'px';
//                var endLeft = e.targetTouches[0].pageX;
//                curT = endLeft - startLeft;
//                dix.style.left = left + curT + 'px'
                                 }
                             }
        );
        img.addEventListener('touchend', function (e) {
                                      div.innerHTML = '手指数：' + e.touches.length + '<br>手指间距：'+0+'<br>初始间距：'+0;
                                       c=0;
//            console.log(window.getComputedStyle(img,null)['width']);
//console.log(img.style.width)

                             }
        )
    }


</script>